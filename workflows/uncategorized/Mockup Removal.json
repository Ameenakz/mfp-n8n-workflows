{
  "updatedAt": "2025-09-01T05:21:23.182Z",
  "createdAt": "2025-08-11T07:45:33.732Z",
  "id": "Gwne2cRxa0rKR3GO",
  "name": "Mockup Removal",
  "description": null,
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        0,
        0
      ],
      "id": "446ae7ad-c687-4c23-b279-3bf485370342",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "url": "=https://j4zewh-kg.myshopify.com/admin/api/2025-04/products/12183929356628.json",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        208,
        0
      ],
      "id": "2e9ecf98-2d0d-4b15-b57a-3e68381b5062",
      "name": "Get_Shopify_Product",
      "credentials": {
        "httpHeaderAuth": {
          "id": "878XnnwYx10R4wXG",
          "name": "Shopify"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const product = $input.item.json.product;\n\nif (!product || !product.images || product.images.length === 0) {\n  console.warn(`No images found for product ID ${product.id}. Skipping cleanup.`);\n  return [{ json: { skipped: true, product_id: product.id } }];\n}\n\nconst itemsToDelete = [];\n\nproduct.images.forEach(image => {\n  // Delete if not assigned to any variants (extras like side/context)\n  if (!image.variant_ids || image.variant_ids.length === 0) {\n    itemsToDelete.push({\n      json: {\n        product_id: product.id,\n        image_id: image.id,\n        image_src: image.src  // For logging\n      }\n    });\n  }\n});\n\nif (itemsToDelete.length === 0) {\n  console.log(`No unwanted mockups found for product ${product.id}.`);\n} else {\n  console.log(`Found ${itemsToDelete.length} unwanted mockups to delete for product ${product.id}.`);\n}\n\nreturn itemsToDelete;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        416,
        0
      ],
      "id": "7f40ab31-c28e-4996-af93-93f39ea7f222",
      "name": "Filter Unwanted Mockups"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        624,
        0
      ],
      "id": "f837fef5-204b-44ba-9a4c-f74a3ad5f569",
      "name": "Loop Image Deletions"
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://j4zewh-kg.myshopify.com/admin/api/2025-04/products/{{ $json.product_id }}/images/{{ $json.image_id }}.json",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        832,
        96
      ],
      "id": "809d7966-167e-43d5-935a-2828717751e5",
      "name": "Delete Unwanted Mockups",
      "credentials": {
        "httpHeaderAuth": {
          "id": "878XnnwYx10R4wXG",
          "name": "Shopify"
        }
      }
    }
  ],
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Get_Shopify_Product",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get_Shopify_Product": {
      "main": [
        [
          {
            "node": "Filter Unwanted Mockups",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Unwanted Mockups": {
      "main": [
        [
          {
            "node": "Loop Image Deletions",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Image Deletions": {
      "main": [
        [],
        [
          {
            "node": "Delete Unwanted Mockups",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete Unwanted Mockups": {
      "main": [
        [
          {
            "node": "Loop Image Deletions",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {},
  "versionId": "49845f7a-6744-4ed5-8a13-3ab6b5928c31",
  "activeVersionId": null,
  "versionCounter": 1,
  "triggerCount": 0,
  "shared": [
    {
      "updatedAt": "2025-08-11T07:45:33.732Z",
      "createdAt": "2025-08-11T07:45:33.732Z",
      "role": "workflow:owner",
      "workflowId": "Gwne2cRxa0rKR3GO",
      "projectId": "lLSHos7ohHn7AjNm",
      "project": {
        "updatedAt": "2025-06-14T17:25:02.061Z",
        "createdAt": "2025-06-14T17:13:49.092Z",
        "id": "lLSHos7ohHn7AjNm",
        "name": "Muhasin Rashid <muhasin@gauger.in>",
        "type": "personal",
        "icon": null,
        "description": null,
        "projectRelations": [
          {
            "updatedAt": "2025-06-14T17:13:49.092Z",
            "createdAt": "2025-06-14T17:13:49.092Z",
            "userId": "f88f8c62-813a-499e-aaee-b5f4da43c5a7",
            "projectId": "lLSHos7ohHn7AjNm",
            "user": {
              "updatedAt": "2025-12-18T05:00:03.582Z",
              "createdAt": "2025-06-14T17:13:45.907Z",
              "id": "f88f8c62-813a-499e-aaee-b5f4da43c5a7",
              "email": "muhasin@gauger.in",
              "firstName": "Muhasin",
              "lastName": "Rashid",
              "personalizationAnswers": {
                "version": "v4",
                "personalization_survey_submitted_at": "2025-06-14T17:25:40.417Z",
                "personalization_survey_n8n_version": "1.97.1",
                "automationGoalDevops": [
                  "other"
                ],
                "automationGoalDevopsOther": "Product",
                "companyType": "ecommerce",
                "role": "engineering"
              },
              "settings": {
                "userActivated": true,
                "easyAIWorkflowOnboarded": true,
                "firstSuccessfulWorkflowId": "JsDBWbsoYaKBkGmW",
                "userActivatedAt": 1758182279933,
                "npsSurvey": {
                  "responded": true,
                  "lastShownAt": 1752395252283
                }
              },
              "disabled": false,
              "mfaEnabled": false,
              "lastActiveAt": "2025-12-18",
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "tags": [],
  "activeVersion": null
}