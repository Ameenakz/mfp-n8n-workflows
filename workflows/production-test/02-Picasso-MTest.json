{
  "updatedAt": "2025-12-18T05:59:12.715Z",
  "createdAt": "2025-11-25T05:28:05.214Z",
  "id": "RyG7Wk8UC5E2L5zs",
  "name": "02-Picasso-MTest",
  "description": null,
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.openai.com/v1/images/edits",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openAiApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "gpt-image-1"
            },
            {
              "name": "prompt",
              "value": "={{ $json.prompt }}"
            },
            {
              "parameterType": "formBinaryData",
              "name": "image[]",
              "inputDataFieldName": "=image0"
            },
            {
              "parameterType": "formBinaryData",
              "name": "image[]",
              "inputDataFieldName": "image1"
            },
            {
              "name": "=n",
              "value": "={{ $json.n }}"
            },
            {
              "name": "quality",
              "value": "={{ $json.quality }}"
            },
            {
              "name": "size",
              "value": "={{ $json.size }}"
            },
            {
              "parameterType": "formBinaryData",
              "name": "image[]",
              "inputDataFieldName": "image2"
            },
            {
              "parameterType": "formBinaryData",
              "name": "image[]",
              "inputDataFieldName": "image3"
            },
            {
              "name": "output_format",
              "value": "={{ $json.output_format }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2336,
        528
      ],
      "id": "7746edc9-dd91-4454-8cd6-3f79c064579b",
      "name": "Edit Image",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "maxTries": 2,
      "executeOnce": false,
      "credentials": {
        "openAiApi": {
          "id": "bW0dWuK2BcJ9Uw2Z",
          "name": "OpenAi account"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "data[0].b64_json",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        3008,
        496
      ],
      "id": "9a74aef2-e09b-49d0-9a54-382a8f3fd700",
      "name": "Convert to File1"
    },
    {
      "parameters": {
        "jsCode": "const body = $json.body || {};\nlet editRequest = \"modify\"; // Default\nconst imageData = [];\n\n// Adjust based on actual Paperform keys\nif (body.data && Array.isArray(body.data)) {\n  body.data.forEach(field => {\n    // Thereâ€™s no 'petDescription' in the sample input, so default stays\n    // Update key if that field is later added to the form\n    \n    if (field.key === '8objr' && Array.isArray(field.value)) {\n      // 8objr = Pet Photos\n      field.value.forEach((photo, index) => {\n        if (photo.url) {\n          imageData.push({\n            url: photo.url,\n            filename: photo.name || `image${index}.jpeg`,\n            mimeType: photo.type || 'image/jpeg',\n            index: index\n          });\n        }\n      });\n    }\n  });\n}\n\n// Return individual items for each image\nreturn imageData.map(img => ({\n  json: {\n    imageUrl: img.url,\n    imageName: img.filename,\n    imageType: img.mimeType,\n    imageIndex: img.index,\n    totalImages: imageData.length,\n    requestType: \"Modify my Product Image\",\n    editRequest: editRequest,\n    submittedAt: new Date().toISOString(),\n    session_id: body.submission_id || \"unknown\"\n  }\n}));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1376,
        992
      ],
      "id": "1c7faacb-44e5-4458-b5f0-ee0e6e0e5643",
      "name": "Parser1"
    },
    {
      "parameters": {
        "url": "={{ $json.imageUrl }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -448,
        1104
      ],
      "id": "9f7a0edf-745b-4484-8df2-974f445b813d",
      "name": "Download_images"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "\nconst item = $input.item; // Current item being processed\n\n// Create a copy of binary data to modify\nconst binaryData = {};\nif (item.binary) {\n  // Fix MIME types for all binary properties\n  for (const key in item.binary) {\n    binaryData[key] = {...item.binary[key]};\n    \n    // Ensure all jpg images use the correct mime type\n    if (binaryData[key].mimeType === 'image/jpg') {\n      binaryData[key].mimeType = 'image/jpeg';\n    }\n  }\n}\n\n// Create a new output item with both the prompt and binary data\nreturn {\n  json: {\n    promptIndex: item.json.promptIndex,\n    prompt: item.json.prompt,\n    theme_name: item.json.theme_name,\n    n: 1,\n    quality: \"low\",//medium,high, auto\n    size: \"1024x1536\",\n    output_format: \"jpeg\",\n    email:$json.email\n  },\n  binary: binaryData // Use the corrected binary data\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1696,
        400
      ],
      "id": "e864e4a4-6c25-4a32-88a8-9607a61898f7",
      "name": "set_imageQUALITY"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloudinary.com/v1_1/myfurryprints/image/upload",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBasicAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "public_id",
              "value": "={{ $json.customFilename }}"
            },
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            },
            {
              "name": "upload_preset",
              "value": "n8n-generations"
            },
            {
              "name": "folder",
              "value": "={{ $json.session_id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3856,
        464
      ],
      "id": "be1a28d5-0f15-4a20-9a4f-e8018454933b",
      "name": "UploadTOCloudery",
      "credentials": {
        "httpBasicAuth": {
          "id": "ZwQuXy3mFoa7bh3H",
          "name": "cloudinaryFurryPrints"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "9a09c669-1cb9-44bc-9da8-00ef3ec54dee",
              "name": "session_id",
              "value": "={{ $json.body.submission_id }}",
              "type": "string"
            },
            {
              "id": "47327c4e-0fe4-4aa5-8a38-0d99e641bdc3",
              "name": "customer_name",
              "value": "={{ $json.body.data[4].value }} {{ $json.body.data[5].value }}",
              "type": "string"
            },
            {
              "id": "1117f85f-c597-444e-87cb-97cece4eb659",
              "name": "email",
              "value": "={{ $json.body.data[6].value }}",
              "type": "string"
            },
            {
              "id": "2f007b58-3fe0-4d48-bf90-43a61f0d4b2d",
              "name": "petname",
              "value": "={{ $json.body.data[2].value }}",
              "type": "string"
            },
            {
              "id": "56b08dbf-6695-4944-87e0-bb031d9e07b8",
              "name": "petKind",
              "value": "={{ $json.body.data[0].value }}",
              "type": "string"
            },
            {
              "id": "f53102c8-ae2e-4909-ba5b-8755bb93669a",
              "name": "petGender",
              "value": "={{ $json.body.data[1].value }}",
              "type": "string"
            },
            {
              "id": "3caa79a5-31c9-47a6-abe6-cf8e11b4d3c5",
              "name": "phoneModel",
              "value": "={{ $json.body.data.find(item => item.key === '7850r')?.value }}",
              "type": "string"
            },
            {
              "id": "85a819d2-a5d8-4299-a953-caf64e128489",
              "name": "phoneNumber",
              "value": "={{ $json.body.phone }}",
              "type": "string"
            },
            {
              "id": "952c9d5e-e909-43f1-9162-a51bf4b9f3ad",
              "name": "worker_token",
              "value": "={{ $('Trigger from Hagrid').item.json.worker_token }}",
              "type": "string"
            },
            {
              "id": "61e27fc4-0c74-4159-b2df-030515e2131e",
              "name": "slot_id",
              "value": "={{ $('Trigger from Hagrid').item.json.slot_id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -880,
        160
      ],
      "id": "e0a09501-f816-4ae0-b47e-5cc7ac31bc8b",
      "name": "Extract Parameters"
    },
    {
      "parameters": {
        "jsCode": "// In the Code3 node, update to include submissionId\nconst items = $input.all();\nconst binaryOutput = {};\nconst imageFiles = [];\nconst submissionId = items[0]?.json?.submissionId || 'default';\n\n// Process all items with downloads\nitems.forEach((item, index) => {\n  if (item.binary && item.binary.data) {\n    // Copy binary data with the correct key name\n    binaryOutput[`image${index}`] = item.binary.data;\n    \n    // Build image metadata\n    imageFiles.push({\n      index: index,\n      filename: item.json.imageName || `image${index}.jpg`,\n      mimeType: item.json.imageType || 'image/jpeg'\n    });\n  }\n});\n\n// Get metadata from the first item\nconst firstItem = items[0] || {};\nconst metadata = {\n  requestType: firstItem.json?.requestType || \"Modify my Product Image\",\n  editRequest: firstItem.json?.editRequest || \"modify\",\n  imageCount: imageFiles.length,\n  imageFiles: imageFiles,\n  submittedAt: firstItem.json?.submittedAt || new Date().toISOString(),\n  submissionId: submissionId\n};\n\n// Return a single item with all image data\nreturn [{\n  json: metadata,\n  binary: binaryOutput\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -192,
        1104
      ],
      "id": "85069d0d-a098-4f41-ae57-32f016cfd74c",
      "name": "Prepare Image Payload"
    },
    {
      "parameters": {
        "numberInputs": 3
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        3488,
        192
      ],
      "id": "1ce3a124-a5f1-4417-8b44-8e4c83c6966f",
      "name": "Merge Upload Data"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        4592,
        192
      ],
      "id": "1e62df24-2f6c-4d8a-9da1-3e28ac15dd40",
      "name": "Merge Customer With Transformations"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "\nconst combinedItemJson = $input.item.json;\n\nconst publicId = combinedItemJson.public_id; // From Cloudinary part of combinedItemJson\nconst cloudName = \"myfurryprints\";\nconst maskId = \"Mask3larger_jpm63l\"; // Ensure this mask ID is correct\n\nconst imageTransformations = {\n  clothing: `https://res.cloudinary.com/${cloudName}/image/upload/e_upscale/f_webp/c_scale,w_4000/l_${maskId},w_4000,fl_cutter/${publicId}`,\n  other: `https://res.cloudinary.com/${cloudName}/image/upload/e_upscale/f_webp/c_scale,w_4000/${publicId}`,\n  watermark:\n`https://res.cloudinary.com/${cloudName}/image/upload/l_MFP-Watermark2_rmmx8z.png/${publicId}`   \n};\n\n// Pass through all fields from combinedItemJson and add/overwrite transformation URLs\nreturn {\n  json: {\n    ...combinedItemJson, // This includes Cloudinary data AND original details like theme_name, promptIndex, email etc.\n    original_url: combinedItemJson.secure_url, // Using secure_url from Cloudinary for consistency\n    collection_image_url: imageTransformations.watermark,\n    transformations: imageTransformations,\n    clothing_url: imageTransformations.clothing,\n    other_url: imageTransformations.other\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4368,
        192
      ],
      "id": "86ce0807-9cb5-4441-9ea1-27f7f3645c91",
      "name": "Transformation"
    },
    {
      "parameters": {
        "jsCode": "// Node Name: Combine Cloudinary with Details\n// Mode: Run Once For All Items\n\n// All Cloudinary responses from the UploadTOCloudery node\nconst cloudinaryResponses = $input.all();\n\n// All original items that were the input to UploadTOCloudery\n// These are the outputs of the 'Prepare Cloudinary Upload' node from its last full run.\nconst allOriginalDetailsItems = $('Prepare Cloudinary Upload1').all();\n\nif (cloudinaryResponses.length === 0) {\n  console.warn(\"Combine Cloudinary: No Cloudinary responses received.\");\n  return [];\n}\nif (allOriginalDetailsItems.length === 0) {\n  console.error(\"Combine Cloudinary: No original details found from 'Prepare Cloudinary Upload'. Cannot merge.\");\n  // Return items indicating error or an empty array\n  return cloudinaryResponses.map(cr => ({ json: { ...cr.json, error: \"Missing original details for merging.\" } }));\n}\n\nconst outputItems = [];\n\ncloudinaryResponses.forEach((cloudinaryItem, loopIndex) => {\n  const cloudinaryResponseJson = cloudinaryItem.json; // This is the actual Cloudinary API response data\n\n  let matchingOriginalDetails = null;\n\n  // Strategy 1: Match using public_id (from Cloudinary) and customFilename (from original details)\n  // Cloudinary public_id is often \"folder/customFilename\" or just \"customFilename\"\n  const publicIdParts = cloudinaryResponseJson.public_id.split('/');\n  const cloudinaryFilenamePart = publicIdParts[publicIdParts.length - 1]; // e.g., \"session_id_promptX\"\n\n  const foundItem = allOriginalDetailsItems.find(\n    origItem => origItem.json.customFilename === cloudinaryFilenamePart\n  );\n  if (foundItem) {\n    matchingOriginalDetails = foundItem.json;\n  }\n\n  // Strategy 2: Fallback to index-based matching if filename match failed (less ideal but a backup)\n  // This assumes UploadTOCloudery processes and outputs items in the same order it received them.\n  if (!matchingOriginalDetails && cloudinaryResponses.length === allOriginalDetailsItems.length) {\n    console.warn(`Combine Cloudinary: Could not match Cloudinary response (public_id: ${cloudinaryResponseJson.public_id}) to original details by filename. Falling back to index ${loopIndex}.`);\n    if (allOriginalDetailsItems[loopIndex]) {\n        matchingOriginalDetails = allOriginalDetailsItems[loopIndex].json;\n    }\n  }\n\n  if (!matchingOriginalDetails) {\n    console.error(`Combine Cloudinary: CRITICAL - Could not find matching original details for Cloudinary response with public_id: ${cloudinaryResponseJson.public_id}. Skipping this item.`);\n    outputItems.push({ json: { ...cloudinaryResponseJson, error: \"Orphaned Cloudinary response - no matching original details.\" } });\n    return; // Skips to the next iteration of forEach\n  }\n\n  // Successfully matched, now combine them\n  const combinedJson = {\n    // All fields from Cloudinary's response\n    ...cloudinaryResponseJson, // This includes asset_id, public_id, secure_url, existing, etc.\n\n    // All fields from the matching originalDetails\n    // This will overwrite any same-named fields from cloudinaryResponseJson if they exist in matchingOriginalDetails,\n    // but mostly they should be distinct (e.g., theme_name, promptIndex are from originalDetails)\n    ...matchingOriginalDetails\n  };\n\n  outputItems.push({ json: combinedJson });\n});\n\nif (outputItems.length !== cloudinaryResponses.length) {\n    console.warn(`Combine Cloudinary: Processed ${outputItems.length} items but received ${cloudinaryResponses.length} Cloudinary responses. Some items may have been skipped due to matching errors.`);\n}\n\nreturn outputItems;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4224,
        352
      ],
      "id": "2d21ba87-6022-44dc-841d-d6b4d7394778",
      "name": "Combine Cloudinary with Details"
    },
    {
      "parameters": {
        "jsCode": "if (!$json.result) {\n  return [];\n}\n\nconst jobData = JSON.parse($json.result);\n\n// Extract images from customer_data array\nconst customerData = jobData.customer_data || [];\nconst imageField = customerData.find(item => item.key === '8objr');\nconst images = imageField ? imageField.value : [];\n\n\n// ðŸ‘‰ Get phone number by key (from your sample it's \"455ij\")\nconst phoneItem = customerData.find(item => item.key === '455ij');\nconst phoneNumber = phoneItem ? phoneItem.value : null;\n\n\n// Transform to match your existing workflow structure\nreturn [{\n  json: {\n    body: {\n      submission_id: jobData.submission_id,\n      data: jobData.customer_data, // Pass the full customer_data array\n      phone: phoneNumber,      // ðŸ‘ˆ added here\n      images: images // Extract the actual images\n    }\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1600,
        816
      ],
      "id": "d71a4211-81f5-4322-96d6-c7a66bdaf5e1",
      "name": "ParseQueueData"
    },
    {
      "parameters": {
        "content": "WORKFLOW 2\n\nThis workflow takes pet images and customer data, generates detailed AI-enhanced prompts for themed artwork, and sends the images for editing. It refines and uploads the results to Cloudinary, applies transformations, and prepares everything for final delivery. Itâ€™s designed to create high-quality, personalized artwork ",
        "height": 300,
        "width": 540,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2144,
        384
      ],
      "id": "651b9318-7244-4cc9-abd1-a566e0580b3c",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "jsCode": "// In your \"distribute images\" Code Node\n\nconst allItems = $input.all();\n\nconst imageItem = allItems.find(item => item.binary && Object.keys(item.binary).length > 0);\nif (!imageItem) {\n  throw new Error(\"Input item with binary image data was not found.\");\n}\nconst binaryData = imageItem.binary;\n\nconst promptDataItem = allItems.find(item => item.json && !item.json.requestType);\nif (!promptDataItem) {\n  throw new Error(\"Input item with prompt data was not found.\");\n}\nconst promptsObject = promptDataItem.json;\n\nconst promptEntries = Object.entries(promptsObject);\n\nreturn promptEntries.map(([theme, promptText], index) => {\n  return {\n    json: {\n      \"promptIndex\": index + 1,\n      \"prompt\": promptText,\n      // --- ADD THIS LINE ---\n      \"theme_name\": theme // This captures the theme like \"Spa Day Deluxe\"\n    },\n    binary: binaryData\n  };\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1376,
        400
      ],
      "id": "07399649-6ebf-45ef-9a68-2d4a69a151e6",
      "name": "Distribute_images"
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\n\nasync function getImageSize(imageUrl) {\n  try {\n    const response = await fetch(imageUrl, { method: 'HEAD' });\n    const contentLength = response.headers.get('content-length');\n    \n    if (contentLength) {\n      const sizeBytes = parseInt(contentLength);\n      const sizeMB = sizeBytes / (1024 * 1024);\n      return {\n        sizeBytes: sizeBytes,\n        sizeMB: Math.round(sizeMB * 100) / 100, // Round to 2 decimals\n        sizeKB: Math.round(sizeBytes / 1024),\n        needsCompression: sizeMB > 3\n      };\n    } else {\n      // Fallback: Download a small portion to estimate size\n      const partialResponse = await fetch(imageUrl, { \n        headers: { 'Range': 'bytes=0-1023' } // First 1KB\n      });\n      \n      if (partialResponse.status === 206) { // Partial content\n        const contentRange = partialResponse.headers.get('content-range');\n        const totalSize = parseInt(contentRange.split('/')[1]);\n        const sizeMB = totalSize / (1024 * 1024);\n        \n        return {\n          sizeBytes: totalSize,\n          sizeMB: Math.round(sizeMB * 100) / 100,\n          sizeKB: Math.round(totalSize / 1024),\n          needsCompression: sizeMB > 3\n        };\n      }\n      \n      // If we can't determine size, assume it needs compression to be safe\n      return {\n        sizeBytes: 0,\n        sizeMB: 0,\n        sizeKB: 0,\n        needsCompression: true\n      };\n    }\n    \n  } catch (error) {\n    console.error(`Error checking size for ${imageUrl}:`, error);\n    // If error, assume it needs compression to be safe\n    return {\n      sizeBytes: 0,\n      sizeMB: 0,\n      sizeKB: 0,\n      needsCompression: true\n    };\n  }\n}\n\n// Process all items\nconst processedItems = [];\n\nfor (const item of items) {\n  console.log(`Checking size for: ${item.json.imageName || 'image'}`);\n  \n  const sizeInfo = await getImageSize(item.json.imageUrl);\n  \n  console.log(`Image size: ${sizeInfo.sizeMB}MB (${sizeInfo.sizeKB}KB) - Compression needed: ${sizeInfo.needsCompression}`);\n  \n  processedItems.push({\n    json: {\n      ...item.json,\n      imageSize: sizeInfo\n    }\n  });\n}\n\nreturn processedItems;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1168,
        816
      ],
      "id": "65207b1b-198e-4d49-b658-10d15fe8b901",
      "name": "ImageSizeCalc"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "1dff80b8-7953-48ac-892b-258d93372659",
              "leftValue": "={{ $json.imageSize.needsCompression }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -960,
        816
      ],
      "id": "f3bced09-301a-4483-ac2e-c2d8ceaf07f7",
      "name": "If"
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -448,
        896
      ],
      "id": "8669c727-68af-479e-bfca-4192e1913d1e",
      "name": "DownloadImages"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloudinary.com/v1_1/myfurryprints/image/upload",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBasicAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "file",
              "value": "={{ $json.imageUrl }}"
            },
            {
              "name": "upload_preset",
              "value": "n8n-temp-compression"
            },
            {
              "name": "tags",
              "value": "temp,auto-compression"
            },
            {
              "name": "folder",
              "value": "temp-compression"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -752,
        816
      ],
      "id": "70640b92-21de-4e31-a836-9195459977fe",
      "name": "UploadToCloudinary11",
      "credentials": {
        "httpBasicAuth": {
          "id": "ZwQuXy3mFoa7bh3H",
          "name": "cloudinaryFurryPrints"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o",
          "mode": "list",
          "cachedResultName": "gpt-4o"
        },
        "options": {
          "responseFormat": "json_object",
          "temperature": 0.1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        32,
        1344
      ],
      "id": "8a34f01d-f932-4f56-929f-b51749c303c7",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "bW0dWuK2BcJ9Uw2Z",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "Analyze the provided input images and return your findings in the required JSON format.",
        "options": {
          "systemMessage": "You are an automated image validation service. Your sole purpose is to analyze a batch of user-uploaded images and return a single JSON array containing one validation object per image. You must check EACH image against the strict criteria provided.\n\n**Validation Criteria for EACH image:**\n1.  `isPetPresent`: Is there at least one dog or cat clearly visible?\n2.  `isSingleSubject`: Is there ONLY one pet in the image?\n3.  `isSafeForWork`: Is the image free of human nudity or graphic violence?\n4.  `isSamePetAcrossImages`: Is all uploaded images have the same pet â€” verified by consistent appearance traits (e.g., fur colour/pattern, facial features, body structure)? \n\n**Output Format Rules:**\n- You MUST respond with a single, valid JSON array ONLY.\n- The array must contain an object for each image you were given, in the same order they were provided (image0, image1, image2, etc.).\n- Do not add any other text, explanations, or markdown formatting like ```json.\n- The structure of each object in the array must follow the specific Output Format Instructions."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        32,
        1104
      ],
      "id": "53c70959-e94f-4b11-87c3-9a6434f35f56",
      "name": "Image validation agent"
    },
    {
      "parameters": {
        "jsCode": "// The input to this node comes from the \"Image validation agent\".\n// Its input, in turn, came from \"Prepare Image Payload\".\n// We need to grab that original data.\nconst originalItem = $('Prepare Image Payload').first();\n\n// Now, parse the new validation result from the agent.\nconst validationResult = JSON.parse($input.first().json.output);\n\n// Return a single item that contains BOTH the original data\n// (including the precious binary files) AND the new validation result.\nreturn [{\n  json: {\n    ...originalItem.json, // Pass through all original JSON data\n    validationResults: validationResult\n  },\n  binary: originalItem.binary // CRITICAL: Pass through the binary data\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        400,
        1104
      ],
      "id": "686eb2aa-5c4e-4bf5-a4ef-346fe3fd1b40",
      "name": "parse validation"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "16132a31-208e-410e-a2ae-efbf1bf5886e",
              "leftValue": "={{ $json.validationResults.isPetPresent }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            },
            {
              "id": "fa96c766-3874-47be-ae9f-a4321fad93ae",
              "leftValue": "={{ $json.validationResults.isSingleSubject }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            },
            {
              "id": "6965ba3a-3e3d-4f3e-9638-fe06bee375c3",
              "leftValue": "={{ $json.validationResults.isSafeForWork }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        592,
        1104
      ],
      "id": "df37d1b2-8bd4-4dce-b74c-cca7e24f3a88",
      "name": "check images are valid"
    },
    {
      "parameters": {
        "jsCode": "// Get the validation results from the input JSON\nconst results = $input.item.json.validationResults;\n\n// Initialize an empty array to hold the reasons for failure\nconst reasons = [];\n\n// Check each validation rule and add a user-friendly message if it failed\nif (results.isPetPresent === false) {\n  reasons.push(\"we could not detect a pet in the images provided\");\n}\n\nif (results.isSingleSubject === false) {\n  reasons.push(\"more than one pet or person was detected in the images\");\n}\n\nif (results.isSafeForWork === false) {\n  reasons.push(\"the images were flagged for containing content that violates our safety policy\");\n}\n\n// Format the final reason string.\nlet finalReason = \"Your image submission could not be processed because \";\n\nif (reasons.length > 1) {\n  // If there are multiple reasons, join them nicely.\n  // Example: \"reason 1 and reason 2\"\n  finalReason += reasons.slice(0, -1).join(', ') + ' and ' + reasons.slice(-1);\n} else {\n  // If there's only one reason.\n  finalReason += reasons[0];\n}\n\nfinalReason += \". Please re-upload your photos, ensuring they meet our guidelines.\";\n\n// Return the final reason in a new JSON object\n// This object will be passed to the 'Send Email' node.\nreturn {\n  json: {\n    rejectionReason: finalReason\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        896,
        1408
      ],
      "id": "4e2b39a7-ad4d-4600-bb99-59b5b752cc4c",
      "name": "get failure reasons"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.petGender }}",
                    "rightValue": "Male",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "b35a53f0-6e04-4f99-bd75-bb4349bde0e9"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "170d7f09-af11-4545-bd9c-a83c8e6e3260",
                    "leftValue": "={{ $json.petGender }}",
                    "rightValue": "Female",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -288,
        400
      ],
      "id": "63310a72-6d0d-43b1-8f96-87d40e3c5161",
      "name": "prompt selector"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b9c416ad-8567-4398-bfc0-0a698641b5fb",
              "name": "Spa Day Deluxe",
              "value": "Create image Create a humorous, photorealistic image of my pet enjoying an extravagant spa day. He should be lying comfortably on a plush massage table, wrapped snugly in fluffy white towels, with slices of cucumber gently resting over his eyes. Surround his with soft, billowing steam, calming candles, and spa decor, capturing every amusing detailâ€”from his relaxed, content expression to the luxurious textures of towels and furâ€”in vivid realism. The atmosphere should be serene yet comedic, mimicking professional high-quality photography. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "6aeb6e6a-e446-4443-897e-d1bb22fcb374",
              "name": "Midnight Snack",
              "value": "Create image Generate a photorealistic image capturing my pet tiptoeing stealthily towards the refrigerator at midnight, the fridge door already open with its light dramatically illuminating his guilty face. He is wearing fuzzy slippers and pajamas, paw halfway inside a cake box. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "efbe2046-a8cc-4564-8d0c-3e9678e01cf9",
              "name": "Victorian Portrait",
              "value": "Create image of my pet as an elegant royal figure from the Victorian era, sitting regally on a velvet throne, wearing a luxurious embroidered robe and a golden crown, depicted in classic oil painting style with warm, rich colors and intricate details. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "30fc7cd9-e639-4ad6-94c7-f8fa0ab4cf44",
              "name": "Harry Petter",
              "value": "Create image Turn my pet into a Hogwarts student from the Harry Potter universe, proudly wearing Gryffindor house robes and scarf, surrounded by magical elements such as floating candles, potion books, a wand, and enchanted objects. Set the scene within Hogwartsâ€™ warm, candlelit Great Hall, capturing the whimsical and magical atmosphere typical of the Harry Potter movies and books. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "23c1ec30-6b36-493c-a80f-f73f72ac42ab",
              "name": "Corporate Pet",
              "value": "Create a funny and photorealistic image of my pet seated professionally behind an executive office desk. The desk includes realistic office items: an open laptop, a coffee mug that clearly says â€œWorldâ€™s Best Boss,â€ a few stacks of paper, and three yellow sticky notes placed on the desk. The sticky notes must have legible text written as follows: First note: â€œCancel the vetâ€, Second note: â€œDouble treats budgetâ€, Third note: â€œQ4 goal: more napsâ€. The pet is wearing a sharp women business suit and stylish glasses, with paw thoughtfully resting on the keyboard of the laptop. Capture the petâ€™s expression as focused but adorably overwhelmed, as if managing a very busy workday. Keep the scene photorealistic with professional office lighting and depth. Do not use elements from previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "63d9ad28-5bd4-4f82-b3e1-01b53882e7ea",
              "name": "Home Yoga",
              "value": "Create image Depict my pet humorously performing a yoga pose (downward dog pose) on a yoga mat, wearing trendy yoga pants and a sweatband, in a calm, serene yoga studio with candles, incense, and lush plants. His expression should look peaceful yet slightly humorous, perfectly balancing realism and comedy. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "c787f5e1-12d3-4916-8d91-236112604492",
              "name": "Morning Coffee",
              "value": "Create image Generate a humorous photorealistic image of my pet casually sitting at a breakfast table, wrapped in a cozy bathrobe, paws around a steaming coffee cup, newspaper or tablet in front of him. Capture a relaxed, slightly sleepy morning vibe, perfectly mimicking a human's routine with realistic detail. Do not use elements from the previously created images. Portrait mode.",
              "type": "string"
            },
            {
              "id": "ed2a71ea-aef4-42af-aef2-4cd9b97ab1e0",
              "name": "Anime Style",
              "value": "Create image Portray my pet as a playful anime character in the middle of an exciting Japanese festival, wearing a vibrant kimono and happily holding a lantern. Surround him with colorful paper lanterns, cherry blossom trees, and bustling festival stalls. Use vibrant, dynamic anime visuals, exaggerated cute expressions, and lively colors typical of popular anime series (My Hero Academia, Spirited Away). Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "cc1d5f73-6390-40e6-ad43-b6c0874f3eb0",
              "name": "Shopping Spree",
              "value": "Create a highly detailed, humorous, photorealistic image of my dog lavishly enjoying an upscale shopping spree on Rodeo Drive. Depict my dog standing elegantly upright, wearing a glamorous fashion dress, an oversized stylish hat, large chic sunglasses, and carrying a small high-fashion purse. She's confidently holding multiple designer shopping bags in her pawsâ€”bags visibly featuring playful renditions of famous luxury brands (like \"Pawda\" instead of \"Prada\" and \"Chewnell\" instead of \"Channel\"). Include behind her an attentive and formally dressed dachshund chauffeur with a chauffeur hat and sunglasses, ready to assist, standing politely besides a luxurious black car parked curbside. Use a central, mid-range camera angle clearly showcasing the lavish setting: luxury boutiques, pristine palm trees, sophisticated storefronts, and vibrant Beverly Hills ambiance. Avoid depicting humans; it's an exclusively canine, high-end shopping fantasy. The dog's expression should radiate charming confidence and amused sophistication, completing the humorous yet refined atmosphere. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        0,
        512
      ],
      "id": "0cc7873c-3633-4700-b577-a809c4d7ac62",
      "name": "Set Prompts(female)"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        272,
        400
      ],
      "id": "61f03daa-28c4-470a-a349-ffca2519ded3",
      "name": "Merge2"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1024,
        400
      ],
      "id": "0ed274ad-5aad-4a71-818c-598b4b85d5f2",
      "name": "combine image and prompt"
    },
    {
      "parameters": {
        "subject": "OpenAI gpt-image-1 prompt rejected by safety system",
        "textContent": "=A prompt was automatically rejected during image generation. Please review and revise the prompt text in the workflow. \n\n- **Session ID:** {{ $json.session_id }}  \n- **Customer Email:** {{ $json.email }} \n- **Prompt Index:** {{ $json.promptIndex }}  \n- **Rejected Prompt:** \"{{ $json.prompt }}\"\n- **Error from OpenAI:** \n{{ $json.error_message }}\n{{ $json.error.cause.status }} :{{ $json.error.cause.code }}\n{{ $json.error.description }}\n",
        "sender": "support@myfurryprints.com",
        "receipients": "=support@myfurryprints.com",
        "additionalFields": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.sendInBlue",
      "typeVersion": 1,
      "position": [
        3088,
        1072
      ],
      "id": "12e8ec42-bad5-4278-9c6e-52096bbc5683",
      "name": "Brevo1",
      "credentials": {
        "sendInBlueApi": {
          "id": "iKQewRm9lysjCraU",
          "name": "Brevo account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2608,
        1072
      ],
      "id": "eb4b0794-adf7-4408-be9a-3c0004671965",
      "name": "Merge"
    },
    {
      "parameters": {
        "operation": "sendTemplate",
        "templateId": 2,
        "receipients": "={{ $('Extract Parameters').first().json.email }}",
        "additionalFields": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.sendInBlue",
      "typeVersion": 1,
      "position": [
        1120,
        1408
      ],
      "id": "341104fe-9334-4b67-a289-d4725f6e68e3",
      "name": "Brevo2",
      "credentials": {
        "sendInBlueApi": {
          "id": "iKQewRm9lysjCraU",
          "name": "Brevo account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "content": "PROMPT SELECTOR ",
        "height": 420,
        "width": 700
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -304,
        256
      ],
      "id": "6a2706e4-4633-42cc-9e3a-3c9a78f652c5",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "779aa312-0d0e-4be5-a161-e3fa48666f44",
              "name": "promptIndex",
              "value": "={{ $json.promptIndex }}",
              "type": "string"
            },
            {
              "id": "660b7a54-146d-4348-8252-a7bea4d918fd",
              "name": "prompt",
              "value": "={{ $json.prompt }}",
              "type": "string"
            },
            {
              "id": "503320fc-b126-4d89-a902-228a8b478fe7",
              "name": "session_id",
              "value": "={{ $('Extract Parameters').first().json.session_id }}",
              "type": "string"
            },
            {
              "id": "32381fd1-0c64-45a0-8b5e-e65a8bdc2bed",
              "name": "error.cause.code",
              "value": "={{ $json.error.cause.status }} :{{ $json.error.cause.code }}",
              "type": "string"
            },
            {
              "id": "7f7e6379-1bb6-46f1-b4c5-93a660dddcff",
              "name": "error_description",
              "value": "={{ $json.error.description }}",
              "type": "string"
            },
            {
              "id": "ffb16a2c-548e-4bf2-8ece-4ac40aa882a9",
              "name": "customer_name",
              "value": "={{ $('Extract Parameters').first().json.customer_name }}",
              "type": "string"
            },
            {
              "id": "64267fbe-a8c5-4480-96d0-7865ac6a5931",
              "name": "email",
              "value": "={{ $('Extract Parameters').first().json.email }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2848,
        1072
      ],
      "id": "62fd18ea-774f-4392-8a2d-9f2cd6592ee6",
      "name": "setting email fields"
    },
    {
      "parameters": {
        "jsCode": "// 1. Grab all merged items\nconst allItems = $input.all();\n\n// 2. Pull out the single customer info object\nconst userDataItem = allItems.find(item => !!item.json.email);\nif (!userDataItem) {\n  throw new Error(\"Could not find customer data item (email) in input\");\n}\nconst customerData = userDataItem.json;\n\n// 3. Pull out all the items that have binary data (i.e. real images)\nconst imageItems = allItems.filter(item => item.binary && Object.keys(item.binary).length);\nif (imageItems.length === 0) {\n  throw new Error(\"No generated images found in input\");\n}\n\n// 4. Pull original prompt metadata from the Keep Metadata node\n//    (Use the node name exactly as it appears in your canvas â€” here I'm using \"Keep Metadata\")\nconst promptMetadataItems = $('keep metadata').all();\nif (!promptMetadataItems.length) {\n  throw new Error(\"Could not find prompt metadata items\");\n}\n\n// 5. Build the upload-ready items\nreturn imageItems.map(imageItem => {\n  const pi = imageItem.json.promptIndex;\n  const promptMeta = promptMetadataItems.find(m => m.json.promptIndex === pi);\n  if (!promptMeta) {\n    throw new Error(`No prompt metadata found for promptIndex ${pi}`);\n  }\n\n  const session_id    = customerData.session_id;\n  const customFilename = `${session_id}_prompt${pi}`;\n\n  return {\n    json: {\n      session_id:    session_id,\n      email:         customerData.email,\n      petname:       customerData.petname,\n      petKind:       customerData.petKind,\n      customer_name: customerData.customer_name,\n      promptIndex:   pi,\n      theme_name:    promptMeta.json.theme_name,\n      customFilename,\n    },\n    binary: {\n      // pass through the same binary field you got from Convert to File\n      data: imageItem.binary.data  \n    }\n  };\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3712,
        272
      ],
      "id": "cfdf0c52-a40d-41dc-8414-52b42624fe0e",
      "name": "Prepare Cloudinary Upload1"
    },
    {
      "parameters": {
        "jsCode": "return $input.all().map(item => ({\n  json: {\n    promptIndex: item.json.promptIndex,\n    prompt: item.json.prompt,\n    theme_name: item.json.theme_name,\n    session_id: item.json.session_id,\n    customer_name: item.json.customer_name,\n    petKind: item.json.petKind,\n    petname: item.json.petname\n  }\n}));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2272,
        272
      ],
      "id": "7db14a86-2e58-44ee-9086-b6e01b6367f1",
      "name": "keep metadata"
    },
    {
      "parameters": {
        "jsCode": "const rejected = $input.all().map(item => item.json.promptIndex);\nreturn [{ json: { rejected } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2592,
        736
      ],
      "id": "0ae54e1d-e8fe-4b4d-ad7c-1978e1d42da6",
      "name": "collect rejected"
    },
    {
      "parameters": {
        "jsCode": "const totalCount = $input.all().length;\nreturn [{ json: { totalCount } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2288,
        784
      ],
      "id": "31d435f9-ea50-4f9c-9c36-bc31a1f7c51c",
      "name": "prompt count"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2832,
        736
      ],
      "id": "f856c145-e991-4cee-ad95-522f1792ed29",
      "name": "to get prompt count"
    },
    {
      "parameters": {
        "jsCode": "// 1. Grab both pieces of JSON from the merged node:\nconst inputItems = $input.all();\n\n// 2. Find the total count and the rejected array:\nlet totalCount = 0;\nlet rejected = [];\n\nfor (const it of inputItems) {\n  if (it.json.totalCount !== undefined) {\n    totalCount = it.json.totalCount;\n  }\n  if (Array.isArray(it.json.rejected)) {\n    rejected = it.json.rejected;\n  }\n}\n\n// 3. Compute the accepted indices:\nconst accepted = [];\nfor (let i = 1; i <= totalCount; i++) {\n  if (!rejected.includes(i)) {\n    accepted.push(i);\n  }\n}\n\n// 4. Emit one item *per* accepted index:\nreturn accepted.map(idx => ({\n  json: { promptIndex: idx }\n}));\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3040,
        736
      ],
      "id": "c67a17e2-9728-43f1-aff4-20a601cf9b88",
      "name": "calculate promptIndex"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        3264,
        592
      ],
      "id": "a9eb7504-5940-4b7f-aa3a-30d1f69620d9",
      "name": "Attach PromptIndex"
    },
    {
      "parameters": {
        "content": "Sending error email\n",
        "height": 220,
        "width": 780,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2544,
        1024
      ],
      "id": "0a2cbc96-3840-4794-9207-33f63ef89b73",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b9c416ad-8567-4398-bfc0-0a698641b5fb",
              "name": "Spa Day Deluxe",
              "value": "Create image Create a humorous, photorealistic image of my pet enjoying an extravagant spa day. He should be lying comfortably on a plush massage table, wrapped snugly in fluffy white towels, with slices of cucumber gently resting over his eyes. Surround his with soft, billowing steam, calming candles, and spa decor, capturing every amusing detailâ€”from his relaxed, content expression to the luxurious textures of towels and furâ€”in vivid realism. The atmosphere should be serene yet comedic, mimicking professional high-quality photography. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "6aeb6e6a-e446-4443-897e-d1bb22fcb374",
              "name": "Midnight Snack",
              "value": "Create image Generate a photorealistic image capturing my pet tiptoeing stealthily towards the refrigerator at midnight, the fridge door already open with its light dramatically illuminating his guilty face. He is wearing fuzzy slippers and pajamas, paw halfway inside a cake box. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "efbe2046-a8cc-4564-8d0c-3e9678e01cf9",
              "name": "Victorian Portrait",
              "value": "Create image of my pet as an elegant royal figure from the Victorian era, sitting regally on a velvet throne, wearing a luxurious embroidered robe and a golden crown, depicted in classic oil painting style with warm, rich colors and intricate details. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "30fc7cd9-e639-4ad6-94c7-f8fa0ab4cf44",
              "name": "Harry Petter",
              "value": "Create image Turn my pet into a Hogwarts student from the Harry Potter universe, proudly wearing Gryffindor house robes and scarf, surrounded by magical elements such as floating candles, potion books, a wand, and enchanted objects. Set the scene within Hogwartsâ€™ warm, candlelit Great Hall, capturing the whimsical and magical atmosphere typical of the Harry Potter movies and books. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "23c1ec30-6b36-493c-a80f-f73f72ac42ab",
              "name": "Corporate Pet",
              "value": "Create a funny and photorealistic image of my pet seated professionally behind an executive office desk. The desk includes realistic office items: an open laptop, a coffee mug that clearly says â€œWorldâ€™s Best Boss,â€ a few stacks of paper, and three yellow sticky notes placed on the desk. The sticky notes must have legible text written as follows: First note: â€œCancel the vetâ€, Second note: â€œDouble treats budgetâ€, Third note: â€œQ4 goal: more napsâ€. The pet is wearing a sharp women business suit and stylish glasses, with paw thoughtfully resting on the keyboard of the laptop. Capture the petâ€™s expression as focused but adorably overwhelmed, as if managing a very busy workday. Keep the scene photorealistic with professional office lighting and depth. Do not use elements from previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "63d9ad28-5bd4-4f82-b3e1-01b53882e7ea",
              "name": "Home Yoga",
              "value": "Create image Depict my pet humorously performing a yoga pose (downward dog pose) on a yoga mat, wearing trendy yoga pants and a sweatband, in a calm, serene yoga studio with candles, incense, and lush plants. His expression should look peaceful yet slightly humorous, perfectly balancing realism and comedy. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "c787f5e1-12d3-4916-8d91-236112604492",
              "name": "Morning Coffee",
              "value": "Create image Generate a humorous photorealistic image of my pet casually sitting at a breakfast table, wrapped in a cozy bathrobe, paws around a steaming coffee cup, newspaper or tablet in front of him. Capture a relaxed, slightly sleepy morning vibe, perfectly mimicking a human's routine with realistic detail. Do not use elements from the previously created images. Portrait mode.",
              "type": "string"
            },
            {
              "id": "ed2a71ea-aef4-42af-aef2-4cd9b97ab1e0",
              "name": "Anime Style",
              "value": "Create image Portray my pet as a playful anime character in the middle of an exciting Japanese festival, wearing a vibrant kimono and happily holding a lantern. Surround him with colorful paper lanterns, cherry blossom trees, and bustling festival stalls. Use vibrant, dynamic anime visuals, exaggerated cute expressions, and lively colors typical of popular anime series (My Hero Academia, Spirited Away). Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "cc1d5f73-6390-40e6-ad43-b6c0874f3eb0",
              "name": "Shopping Spree",
              "value": "Create a highly detailed, humorous, photorealistic image of my dog lavishly enjoying an upscale shopping spree on Rodeo Drive. Depict my dog standing elegantly upright, wearing a glamorous fashion dress, an oversized stylish hat, large chic sunglasses, and carrying a small high-fashion purse. She's confidently holding multiple designer shopping bags in her pawsâ€”bags visibly featuring playful renditions of famous luxury brands (like \"Pawda\" instead of \"Prada\" and \"Chewnell\" instead of \"Channel\"). Include behind her an attentive and formally dressed dachshund chauffeur with a chauffeur hat and sunglasses, ready to assist, standing politely besides a luxurious black car parked curbside. Use a central, mid-range camera angle clearly showcasing the lavish setting: luxury boutiques, pristine palm trees, sophisticated storefronts, and vibrant Beverly Hills ambiance. Avoid depicting humans; it's an exclusively canine, high-end shopping fantasy. The dog's expression should radiate charming confidence and amused sophistication, completing the humorous yet refined atmosphere. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        0,
        0
      ],
      "id": "d41dc157-53f2-41b2-99b2-5824bec0d9c1",
      "name": "Set Prompts(female)1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b9c416ad-8567-4398-bfc0-0a698641b5fb",
              "name": "Spa Day Deluxe",
              "value": "Create image Create a humorous, photorealistic image of my pet enjoying an extravagant spa day. He should be lying comfortably on a plush massage table, wrapped snugly in fluffy white towels, with slices of cucumber gently resting over his eyes. Surround his with soft, billowing steam, calming candles, and spa decor, capturing every amusing detailâ€”from his relaxed, content expression to the luxurious textures of towels and furâ€”in vivid realism. The atmosphere should be serene yet comedic, mimicking professional high-quality photography. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "6aeb6e6a-e446-4443-897e-d1bb22fcb374",
              "name": "Midnight Snack",
              "value": "Create image Generate a photorealistic image capturing my pet tiptoeing stealthily towards the refrigerator at midnight, the fridge door already open with its light dramatically illuminating his guilty face. He is wearing fuzzy slippers and pajamas, paw halfway inside a cake box. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "efbe2046-a8cc-4564-8d0c-3e9678e01cf9",
              "name": "Victorian Portrait",
              "value": "Create image of my pet as an elegant royal figure from the Victorian era, sitting regally on a velvet throne, wearing a luxurious embroidered robe and a golden crown, depicted in classic oil painting style with warm, rich colors and intricate details. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "30fc7cd9-e639-4ad6-94c7-f8fa0ab4cf44",
              "name": "Harry Petter",
              "value": "Create image Turn my pet into a Hogwarts student from the Harry Potter universe, proudly wearing Gryffindor house robes and scarf, surrounded by magical elements such as floating candles, potion books, a wand, and enchanted objects. Set the scene within Hogwartsâ€™ warm, candlelit Great Hall, capturing the whimsical and magical atmosphere typical of the Harry Potter movies and books. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "23c1ec30-6b36-493c-a80f-f73f72ac42ab",
              "name": "Corporate Pet",
              "value": "Create a funny and photorealistic image of my pet seated professionally behind an executive office desk. The desk includes realistic office items: an open laptop, a coffee mug that clearly says â€œWorldâ€™s Best Boss,â€ a few stacks of paper, and three yellow sticky notes placed on the desk. The sticky notes must have legible text written as follows: First note: â€œCancel the vetâ€, Second note: â€œDouble treats budgetâ€, Third note: â€œQ4 goal: more napsâ€. The pet is wearing a sharp business suit and stylish glasses, with paw thoughtfully resting on the keyboard of the laptop. Capture the petâ€™s expression as focused but adorably overwhelmed, as if managing a very busy workday. Keep the scene photorealistic with professional office lighting and depth. Do not use elements from previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "63d9ad28-5bd4-4f82-b3e1-01b53882e7ea",
              "name": "Home Yoga",
              "value": "Create image Depict my pet humorously performing a yoga pose (downward dog pose) on a yoga mat, wearing trendy yoga pants and a sweatband, in a calm, serene yoga studio with candles, incense, and lush plants. His expression should look peaceful yet slightly humorous, perfectly balancing realism and comedy. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "0e8016c9-0d38-42f8-8f55-faa87695ccf0",
              "name": "Game of Thrones",
              "value": "Create a photorealistic digital painting of my pet depicted as a noble warrior in the Game of Thrones universe. The pet is sitting regally on the Iron Throne, wearing intricately engraved dark steel medieval armor with leather straps and embossed chest plating. Draped over its shoulders is a thick black fur-lined cloak that blends into the dramatic lighting of the dim throne room. The eyes of my pet stare forward with commanding authority, its expression calm and resolute. To ensure print clarity on dark backgrounds, subtly increase overall ambient brightness, as if a soft omni light gently fills the chamberâ€”just enough to lift the darkest areas without flattening the shadows. Introduce selective rim lighting and cool ambient highlights along armor edges, facial contours, and cloak folds. Let soft snowflakes drift through the cold air, catching glimmers of light. Illuminate key elementsâ€”like the sword tips of the throne and the petâ€™s faceâ€”with a more focused, directional glow from wall-mounted torches and faint icy light from an unseen source. The Iron Throne looms behind, forged from twisted swords, with shadowed edges and a cold steel texture. The tone should remain moody, epic, and richly detailedâ€”evoking the ambiance of Winterfell or the Nightâ€™s Watchâ€”but with enough overall tonal clarity and lifted shadow detail to reproduce beautifully on black T-shirts or other dark surfaces. Do not use elements from previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "c787f5e1-12d3-4916-8d91-236112604492",
              "name": "Morning Coffee",
              "value": "Create image Generate a humorous photorealistic image of my pet casually sitting at a breakfast table, wrapped in a cozy bathrobe, paws around a steaming coffee cup, newspaper or tablet in front of him. Capture a relaxed, slightly sleepy morning vibe, perfectly mimicking a human's routine with realistic detail. Do not use elements from the previously created images. Portrait mode.",
              "type": "string"
            },
            {
              "id": "ed2a71ea-aef4-42af-aef2-4cd9b97ab1e0",
              "name": "Anime Style",
              "value": "Create image Portray my pet as a playful anime character in the middle of an exciting Japanese festival, wearing a vibrant kimono and happily holding a lantern. Surround him with colorful paper lanterns, cherry blossom trees, and bustling festival stalls. Use vibrant, dynamic anime visuals, exaggerated cute expressions, and lively colors typical of popular anime series (My Hero Academia, Spirited Away). Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "cb688f07-c8bb-42e4-b6e1-9d40c19fed14",
              "name": "The Viking",
              "value": "Depict my dog as a proud, accomplished Viking warrior hero, standing alone atop a small rise overlooking his idyllic Norse village nestled peacefully in a snowy valley. He's prominently featured with a larger, imposing presence, wearing richly detailed armor, a decorative cloak, and polished Viking jewelry. Clearly feature detailed village architectureâ€”charming wooden huts, stone pathways, festive decorationsâ€”and stunning snowy mountain landscapes in the distance. His expression conveys a sense of quiet triumph, pride, and thoughtful contentment, perfectly reflecting the beauty and tranquility of his homecoming without the distraction of additional characters. Do not use elements from previously created images. Vertical orientation. Do not make my pet with human hands, keep them as paws.",
              "type": "string"
            },
            {
              "id": "585e808d-d417-4fe5-8f9f-194f8c1202a9",
              "name": "Sherlock Bones",
              "value": "Create image Create a whimsical detective scene depicting my pet as Sherlock Holmes, complete with detective cap, pipe, tweed jacket and a closed umbrella,  carefully investigating with a magnifying glass mysterious paw prints in a misty Victorian London street scene. The style should mimic detailed ink illustration with muted vintage colors. Do not use elements from the previously created images",
              "type": "string"
            },
            {
              "id": "d4ef125a-35e1-4a70-b99a-154283f48a3f",
              "name": "Masterchef",
              "value": "Create image Illustrate a photorealistic and amusing scene of my pet dressed in chef whites and tall chef's hat, expertly cooking in a professional kitchen, carefully seasoning a gourmet meal with paws delicately holding utensils. The setting includes fresh ingredients, sizzling pans, spice jars, and a bustling kitchen background. Do not use elements from the previously created images",
              "type": "string"
            },
            {
              "id": "ae2b1ee8-aada-4241-8514-035a63e4ba6f",
              "name": "Pop Art",
              "value": "Create image Create an eye-catching Pop Art portrait of my pet inspired by Andy Warhol, showcasing multiple colorful repetitions of his face in a grid layout. Each repetition should use bold contrasting colors like neon pink, electric blue, bright yellow, and vivid green, defined by sharp lines and a graphic print-like appearance characteristic of Warholâ€™s iconic style. Do not use elements from the previously created images",
              "type": "string"
            },
            {
              "id": "f9780029-a27f-4370-8458-f25c9ff2b396",
              "name": "Space Explorer Adventure",
              "value": "Create a cosmic Space Explorer portrait of my pet, illustrated wearing a sleek astronaut suit with glowing blue accents. Place them inside a spaceship cockpit with stars, galaxies, and nebulae visible through panoramic windows. Use dramatic lighting and reflective textures for a cinematic sci-fi feel. Do not reuse elements from previous images.",
              "type": "string"
            },
            {
              "id": "28cfd26e-92b0-4b12-9a7f-5142a435607a",
              "name": "Tropical Beach Vacation",
              "value": "Create a fun Tropical Vacation portrait of my pet, relaxing on a sandy beach under a colorful umbrella. Add turquoise waters, palm trees, and soft sun flares in the background. Style should be vibrant, summery, and cheerful. Do not use elements from prior images.",
              "type": "string"
            },
            {
              "id": "55323770-8506-4800-9812-86c91305a169",
              "name": "Snowy Christmas Wonderland",
              "value": "Create a cozy Christmas Wonderland portrait of my pet, sitting beside a warmly lit holiday tree with glowing ornaments. Add soft falling snow, warm lighting, and festive decorations. Style should feel magical and heartwarming. Avoid previous elements.",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        16,
        304
      ],
      "id": "b31a1403-ae56-4ffa-b851-26b31c5e05c2",
      "name": "Set Prompts(male)"
    },
    {
      "parameters": {
        "inputSource": "passthrough"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -1808,
        816
      ],
      "id": "175710da-4282-4caa-8957-1999fb15ac2a",
      "name": "Trigger from Hagrid"
    },
    {
      "parameters": {
        "url": "https://honest-ghoul-37248.upstash.io/set/picasso_lock/active/NX/EX/600",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1056,
        -272
      ],
      "id": "120c1456-cfd9-42c2-911e-3063dacdaa8f",
      "name": "Try Acquire Picasso Lock",
      "credentials": {
        "httpHeaderAuth": {
          "id": "OU4p8zTKeY9k8OYC",
          "name": "Upstash_new"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a34a4979-3557-40d7-a928-101cb8970eef",
              "leftValue": "={{ $json.result }}",
              "rightValue": "OK",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1328,
        -240
      ],
      "id": "c5e0f920-c0ad-4f3d-b0a4-6a783b5a9e32",
      "name": "Got Lock ?",
      "disabled": true
    },
    {
      "parameters": {
        "amount": 1,
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1712,
        -352
      ],
      "id": "431ac4e8-e85c-43c0-befd-eb283e8675b7",
      "name": "Wait for Lock",
      "webhookId": "4ce54760-d490-4f69-8879-7d76579db1e2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://honest-ghoul-37248.upstash.io/del/picasso_lock",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3344,
        1344
      ],
      "id": "ba1344ec-d310-4c43-81ec-fc890ee85173",
      "name": "Release Picasso Lock1",
      "credentials": {
        "httpHeaderAuth": {
          "id": "OU4p8zTKeY9k8OYC",
          "name": "Upstash_new"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://honest-ghoul-37248.upstash.io/del/picasso_lock",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1536,
        -336
      ],
      "id": "372a8878-c4bb-41e4-8369-f4fa65757f2c",
      "name": "Release Picasso Lock",
      "credentials": {
        "httpHeaderAuth": {
          "id": "OU4p8zTKeY9k8OYC",
          "name": "Upstash_new"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "YpaJRhbyQzp3t6NV",
          "mode": "list",
          "cachedResultUrl": "/workflow/YpaJRhbyQzp3t6NV",
          "cachedResultName": "03-Ford-MTest"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {
          "waitForSubWorkflow": false
        }
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        4992,
        192
      ],
      "id": "9401499c-12b2-47b0-b328-04d17dd554f8",
      "name": "Call '03-Ford-MTest'",
      "executeOnce": false
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b9c416ad-8567-4398-bfc0-0a698641b5fb",
              "name": "Spa Day Deluxe",
              "value": "Create image Create a humorous, photorealistic image of my pet enjoying an extravagant spa day. He should be lying comfortably on a plush massage table, wrapped snugly in fluffy white towels, with slices of cucumber gently resting over his eyes. Surround his with soft, billowing steam, calming candles, and spa decor, capturing every amusing detailâ€”from his relaxed, content expression to the luxurious textures of towels and furâ€”in vivid realism. The atmosphere should be serene yet comedic, mimicking professional high-quality photography. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "6aeb6e6a-e446-4443-897e-d1bb22fcb374",
              "name": "Midnight Snack",
              "value": "Create image Generate a photorealistic image capturing my pet tiptoeing stealthily towards the refrigerator at midnight, the fridge door already open with its light dramatically illuminating his guilty face. He is wearing fuzzy slippers and pajamas, paw halfway inside a cake box. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "efbe2046-a8cc-4564-8d0c-3e9678e01cf9",
              "name": "Victorian Portrait",
              "value": "Create image of my pet as an elegant royal figure from the Victorian era, sitting regally on a velvet throne, wearing a luxurious embroidered robe and a golden crown, depicted in classic oil painting style with warm, rich colors and intricate details. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "30fc7cd9-e639-4ad6-94c7-f8fa0ab4cf44",
              "name": "Harry Petter",
              "value": "Create image Turn my pet into a Hogwarts student from the Harry Potter universe, proudly wearing Gryffindor house robes and scarf, surrounded by magical elements such as floating candles, potion books, a wand, and enchanted objects. Set the scene within Hogwartsâ€™ warm, candlelit Great Hall, capturing the whimsical and magical atmosphere typical of the Harry Potter movies and books. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "23c1ec30-6b36-493c-a80f-f73f72ac42ab",
              "name": "Corporate Pet",
              "value": "Create a funny and photorealistic image of my pet seated professionally behind an executive office desk. The desk includes realistic office items: an open laptop, a coffee mug that clearly says â€œWorldâ€™s Best Boss,â€ a few stacks of paper, and three yellow sticky notes placed on the desk. The sticky notes must have legible text written as follows: First note: â€œCancel the vetâ€, Second note: â€œDouble treats budgetâ€, Third note: â€œQ4 goal: more napsâ€. The pet is wearing a sharp business suit and stylish glasses, with paw thoughtfully resting on the keyboard of the laptop. Capture the petâ€™s expression as focused but adorably overwhelmed, as if managing a very busy workday. Keep the scene photorealistic with professional office lighting and depth. Do not use elements from previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "63d9ad28-5bd4-4f82-b3e1-01b53882e7ea",
              "name": "Home Yoga",
              "value": "Create image Depict my pet humorously performing a yoga pose (downward dog pose) on a yoga mat, wearing trendy yoga pants and a sweatband, in a calm, serene yoga studio with candles, incense, and lush plants. His expression should look peaceful yet slightly humorous, perfectly balancing realism and comedy. Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "0e8016c9-0d38-42f8-8f55-faa87695ccf0",
              "name": "Game of Thrones",
              "value": "Create a photorealistic digital painting of my pet depicted as a noble warrior in the Game of Thrones universe. The pet is sitting regally on the Iron Throne, wearing intricately engraved dark steel medieval armor with leather straps and embossed chest plating. Draped over its shoulders is a thick black fur-lined cloak that blends into the dramatic lighting of the dim throne room. The eyes of my pet stare forward with commanding authority, its expression calm and resolute. To ensure print clarity on dark backgrounds, subtly increase overall ambient brightness, as if a soft omni light gently fills the chamberâ€”just enough to lift the darkest areas without flattening the shadows. Introduce selective rim lighting and cool ambient highlights along armor edges, facial contours, and cloak folds. Let soft snowflakes drift through the cold air, catching glimmers of light. Illuminate key elementsâ€”like the sword tips of the throne and the petâ€™s faceâ€”with a more focused, directional glow from wall-mounted torches and faint icy light from an unseen source. The Iron Throne looms behind, forged from twisted swords, with shadowed edges and a cold steel texture. The tone should remain moody, epic, and richly detailedâ€”evoking the ambiance of Winterfell or the Nightâ€™s Watchâ€”but with enough overall tonal clarity and lifted shadow detail to reproduce beautifully on black T-shirts or other dark surfaces. Do not use elements from previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "c787f5e1-12d3-4916-8d91-236112604492",
              "name": "Morning Coffee",
              "value": "Create image Generate a humorous photorealistic image of my pet casually sitting at a breakfast table, wrapped in a cozy bathrobe, paws around a steaming coffee cup, newspaper or tablet in front of him. Capture a relaxed, slightly sleepy morning vibe, perfectly mimicking a human's routine with realistic detail. Do not use elements from the previously created images. Portrait mode.",
              "type": "string"
            },
            {
              "id": "ed2a71ea-aef4-42af-aef2-4cd9b97ab1e0",
              "name": "Anime Style",
              "value": "Create image Portray my pet as a playful anime character in the middle of an exciting Japanese festival, wearing a vibrant kimono and happily holding a lantern. Surround him with colorful paper lanterns, cherry blossom trees, and bustling festival stalls. Use vibrant, dynamic anime visuals, exaggerated cute expressions, and lively colors typical of popular anime series (My Hero Academia, Spirited Away). Do not use elements from the previously created images. Centered composition, vertical orientation.",
              "type": "string"
            },
            {
              "id": "cb688f07-c8bb-42e4-b6e1-9d40c19fed14",
              "name": "The Viking",
              "value": "Depict my dog as a proud, accomplished Viking warrior hero, standing alone atop a small rise overlooking his idyllic Norse village nestled peacefully in a snowy valley. He's prominently featured with a larger, imposing presence, wearing richly detailed armor, a decorative cloak, and polished Viking jewelry. Clearly feature detailed village architectureâ€”charming wooden huts, stone pathways, festive decorationsâ€”and stunning snowy mountain landscapes in the distance. His expression conveys a sense of quiet triumph, pride, and thoughtful contentment, perfectly reflecting the beauty and tranquility of his homecoming without the distraction of additional characters. Do not use elements from previously created images. Vertical orientation. Do not make my pet with human hands, keep them as paws.",
              "type": "string"
            },
            {
              "id": "585e808d-d417-4fe5-8f9f-194f8c1202a9",
              "name": "Sherlock Bones",
              "value": "Create image Create a whimsical detective scene depicting my pet as Sherlock Holmes, complete with detective cap, pipe, tweed jacket and a closed umbrella,  carefully investigating with a magnifying glass mysterious paw prints in a misty Victorian London street scene. The style should mimic detailed ink illustration with muted vintage colors. Do not use elements from the previously created images",
              "type": "string"
            },
            {
              "id": "d4ef125a-35e1-4a70-b99a-154283f48a3f",
              "name": "Masterchef",
              "value": "Create image Illustrate a photorealistic and amusing scene of my pet dressed in chef whites and tall chef's hat, expertly cooking in a professional kitchen, carefully seasoning a gourmet meal with paws delicately holding utensils. The setting includes fresh ingredients, sizzling pans, spice jars, and a bustling kitchen background. Do not use elements from the previously created images",
              "type": "string"
            },
            {
              "id": "ae2b1ee8-aada-4241-8514-035a63e4ba6f",
              "name": "Pop Art",
              "value": "Create image Create an eye-catching Pop Art portrait of my pet inspired by Andy Warhol, showcasing multiple colorful repetitions of his face in a grid layout. Each repetition should use bold contrasting colors like neon pink, electric blue, bright yellow, and vivid green, defined by sharp lines and a graphic print-like appearance characteristic of Warholâ€™s iconic style. Do not use elements from the previously created images",
              "type": "string"
            },
            {
              "id": "f9780029-a27f-4370-8458-f25c9ff2b396",
              "name": "Space Explorer Adventure",
              "value": "Create a cosmic Space Explorer portrait of my pet, illustrated wearing a sleek astronaut suit with glowing blue accents. Place them inside a spaceship cockpit with stars, galaxies, and nebulae visible through panoramic windows. Use dramatic lighting and reflective textures for a cinematic sci-fi feel. Do not reuse elements from previous images.",
              "type": "string"
            },
            {
              "id": "28cfd26e-92b0-4b12-9a7f-5142a435607a",
              "name": "Tropical Beach Vacation",
              "value": "Create a fun Tropical Vacation portrait of my pet, relaxing on a sandy beach under a colorful umbrella. Add turquoise waters, palm trees, and soft sun flares in the background. Style should be vibrant, summery, and cheerful. Do not use elements from prior images.",
              "type": "string"
            },
            {
              "id": "55323770-8506-4800-9812-86c91305a169",
              "name": "Snowy Christmas Wonderland",
              "value": "Create a cozy Christmas Wonderland portrait of my pet, sitting beside a warmly lit holiday tree with glowing ornaments. Add soft falling snow, warm lighting, and festive decorations. Style should feel magical and heartwarming. Avoid previous elements.",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        464,
        -48
      ],
      "id": "70ad6e3c-c415-45ec-943d-9757b99b70dd",
      "name": "extra prompts"
    }
  ],
  "connections": {
    "Edit Image": {
      "main": [
        [
          {
            "node": "Convert to File1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          },
          {
            "node": "collect rejected",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File1": {
      "main": [
        [
          {
            "node": "Attach PromptIndex",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parser1": {
      "main": [
        [
          {
            "node": "ImageSizeCalc",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download_images": {
      "main": [
        [
          {
            "node": "Prepare Image Payload",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "set_imageQUALITY": {
      "main": [
        [
          {
            "node": "Edit Image",
            "type": "main",
            "index": 0
          },
          {
            "node": "keep metadata",
            "type": "main",
            "index": 0
          },
          {
            "node": "prompt count",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "UploadTOCloudery": {
      "main": [
        [
          {
            "node": "Combine Cloudinary with Details",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Parameters": {
      "main": [
        [
          {
            "node": "prompt selector",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge Upload Data",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge Customer With Transformations",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Prepare Image Payload": {
      "main": [
        [
          {
            "node": "Image validation agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Upload Data": {
      "main": [
        [
          {
            "node": "Prepare Cloudinary Upload1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Customer With Transformations": {
      "main": [
        [
          {
            "node": "Call '03-Ford-MTest'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transformation": {
      "main": [
        [
          {
            "node": "Merge Customer With Transformations",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Combine Cloudinary with Details": {
      "main": [
        [
          {
            "node": "Transformation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ParseQueueData": {
      "main": [
        [
          {
            "node": "Extract Parameters",
            "type": "main",
            "index": 0
          },
          {
            "node": "Parser1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Distribute_images": {
      "main": [
        [
          {
            "node": "set_imageQUALITY",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ImageSizeCalc": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "UploadToCloudinary11",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Download_images",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DownloadImages": {
      "main": [
        [
          {
            "node": "Prepare Image Payload",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "UploadToCloudinary11": {
      "main": [
        [
          {
            "node": "DownloadImages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Image validation agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Image validation agent": {
      "main": [
        [
          {
            "node": "parse validation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "parse validation": {
      "main": [
        [
          {
            "node": "check images are valid",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "check images are valid": {
      "main": [
        [
          {
            "node": "combine image and prompt",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "get failure reasons",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get failure reasons": {
      "main": [
        [
          {
            "node": "Brevo2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "prompt selector": {
      "main": [
        [
          {
            "node": "Set Prompts(male)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Set Prompts(female)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Prompts(female)": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge2": {
      "main": [
        [
          {
            "node": "combine image and prompt",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "combine image and prompt": {
      "main": [
        [
          {
            "node": "Distribute_images",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "setting email fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Brevo2": {
      "main": [
        []
      ]
    },
    "setting email fields": {
      "main": [
        [
          {
            "node": "Brevo1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Cloudinary Upload1": {
      "main": [
        [
          {
            "node": "UploadTOCloudery",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "prompt count": {
      "main": [
        [
          {
            "node": "to get prompt count",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "collect rejected": {
      "main": [
        [
          {
            "node": "to get prompt count",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "to get prompt count": {
      "main": [
        [
          {
            "node": "calculate promptIndex",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "calculate promptIndex": {
      "main": [
        [
          {
            "node": "Attach PromptIndex",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "keep metadata": {
      "main": [
        [
          {
            "node": "Merge Upload Data",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Attach PromptIndex": {
      "main": [
        [
          {
            "node": "Merge Upload Data",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Set Prompts(male)": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger from Hagrid": {
      "main": [
        [
          {
            "node": "ParseQueueData",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Try Acquire Picasso Lock": {
      "main": [
        []
      ]
    },
    "Got Lock ?": {
      "main": [
        [
          {
            "node": "Release Picasso Lock",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "Wait for Lock": {
      "main": [
        []
      ]
    },
    "Brevo1": {
      "main": [
        [
          {
            "node": "Release Picasso Lock1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false,
    "errorWorkflow": "e3A2YjP2DNbrfl9C",
    "saveDataErrorExecution": "all",
    "saveDataSuccessExecution": "all",
    "saveManualExecutions": true
  },
  "staticData": null,
  "meta": null,
  "pinData": {
    "Trigger from Hagrid": [
      {
        "json": {
          "result": "{\"submission_id\":\"69392e44d8e541d9fd0ac61d\",\"customer_data\":[{\"title\":\"Who is your furry friend ? \",\"description\":\"\",\"type\":\"choices\",\"key\":\"tjhn\",\"custom_key\":null,\"value\":\"Dog\"},{\"title\":\"What is your pet's sex?\",\"description\":null,\"type\":\"choices\",\"key\":\"70foo\",\"custom_key\":null,\"value\":\"Female\"},{\"title\":\"Your pet's name\",\"description\":\"\",\"type\":\"text\",\"key\":\"1pl93\",\"custom_key\":null,\"value\":\"Test Dolly\"},{\"title\":\"Pet photos\",\"description\":\"Please upload 4 to 6 pictures of your pet\",\"type\":\"image\",\"key\":\"8objr\",\"custom_key\":null,\"value\":[{\"url\":\"https://paperform.co/file/s3.amazonaws.com/pf-user-files-01/t-474237/uploads/2025-12-10/wb6223h/Luna%20Body%202.jpeg?expires=1765959876&signature=e33ae94959305ad4ada9cefe71d2f54e5eab80a785938261e4803e7dca1f1471\",\"name\":\"Luna Body 2.jpeg\",\"type\":\"image/jpeg\",\"size\":92629,\"width\":1200,\"height\":1600},{\"url\":\"https://paperform.co/file/s3.amazonaws.com/pf-user-files-01/t-474237/uploads/2025-12-10/y8822rd/Luna%20Body%205.jpeg?expires=1765959876&signature=b169f11c437b23f33c426a57af7eb7fa143f2fd93f15a5e241310abf76537b16\",\"name\":\"Luna Body 5.jpeg\",\"type\":\"image/jpeg\",\"size\":331584,\"width\":1500,\"height\":2000},{\"url\":\"https://paperform.co/file/s3.amazonaws.com/pf-user-files-01/t-474237/uploads/2025-12-10/xg722zs/Luna%20Face%204.jpeg?expires=1765959876&signature=ccc99c96c06193d986e841e5964a110c5b202311d9e4b11b0eb15a49e20b35f5\",\"name\":\"Luna Face 4.jpeg\",\"type\":\"image/jpeg\",\"size\":207024,\"width\":1500,\"height\":2000},{\"url\":\"https://paperform.co/file/s3.amazonaws.com/pf-user-files-01/t-474237/uploads/2025-12-10/yz922l3/Luna%20Face%205.jpeg?expires=1765959876&signature=d6d5d1cccf2ec70f3cce2d8295c5e8e7ccfd50b1e667048bce84ef1c16815bc1\",\"name\":\"Luna Face 5.jpeg\",\"type\":\"image/jpeg\",\"size\":277134,\"width\":1500,\"height\":2000},{\"url\":\"https://paperform.co/file/s3.amazonaws.com/pf-user-files-01/t-474237/uploads/2025-12-10/zqa22bt/Luna%20Face%201.jpg?expires=1765959876&signature=08fb08858fa6c494655117682b9f1965e0b5f4f904ba091a3d59a21d62707ca5\",\"name\":\"Luna Face 1.jpg\",\"type\":\"image/jpeg\",\"size\":743979,\"width\":3000,\"height\":4000}]},{\"title\":\"First name\",\"description\":\"\",\"type\":\"text\",\"key\":\"84g9u\",\"custom_key\":null,\"value\":\"Ameena\"},{\"title\":\"Last name\",\"description\":\"\",\"type\":\"text\",\"key\":\"b6vtr\",\"custom_key\":null,\"value\":\"K\"},{\"title\":\"Email\",\"description\":\"\",\"type\":\"email\",\"key\":\"aohp1\",\"custom_key\":null,\"value\":\"ameena.k@gauger.in\"},{\"title\":\"Phone (optional)\",\"description\":\"We'll text you when artwork is ready\",\"type\":\"phone\",\"key\":\"455ij\",\"custom_key\":null,\"value\":null},{\"title\":\"What is your phone model?\",\"description\":\"Used to show your petâ€™s artwork on a phone case\",\"type\":\"dropdown\",\"key\":\"7850r\",\"custom_key\":null,\"value\":\"Samsung Galaxy S21 FE\"}],\"timestamp\":\"2025-12-10T08:24:37.392Z\"}",
          "worker_token": "69392e44d8e541d9fd0ac61d",
          "slot_id": 1
        }
      }
    ]
  },
  "versionId": "e9d44eca-1469-4b96-a061-b1b790c40a15",
  "activeVersionId": null,
  "versionCounter": 19,
  "triggerCount": 0,
  "shared": [
    {
      "updatedAt": "2025-11-25T05:28:05.214Z",
      "createdAt": "2025-11-25T05:28:05.214Z",
      "role": "workflow:owner",
      "workflowId": "RyG7Wk8UC5E2L5zs",
      "projectId": "lLSHos7ohHn7AjNm",
      "project": {
        "updatedAt": "2025-06-14T17:25:02.061Z",
        "createdAt": "2025-06-14T17:13:49.092Z",
        "id": "lLSHos7ohHn7AjNm",
        "name": "Muhasin Rashid <muhasin@gauger.in>",
        "type": "personal",
        "icon": null,
        "description": null,
        "projectRelations": [
          {
            "updatedAt": "2025-06-14T17:13:49.092Z",
            "createdAt": "2025-06-14T17:13:49.092Z",
            "userId": "f88f8c62-813a-499e-aaee-b5f4da43c5a7",
            "projectId": "lLSHos7ohHn7AjNm",
            "user": {
              "updatedAt": "2025-12-18T05:00:03.582Z",
              "createdAt": "2025-06-14T17:13:45.907Z",
              "id": "f88f8c62-813a-499e-aaee-b5f4da43c5a7",
              "email": "muhasin@gauger.in",
              "firstName": "Muhasin",
              "lastName": "Rashid",
              "personalizationAnswers": {
                "version": "v4",
                "personalization_survey_submitted_at": "2025-06-14T17:25:40.417Z",
                "personalization_survey_n8n_version": "1.97.1",
                "automationGoalDevops": [
                  "other"
                ],
                "automationGoalDevopsOther": "Product",
                "companyType": "ecommerce",
                "role": "engineering"
              },
              "settings": {
                "userActivated": true,
                "easyAIWorkflowOnboarded": true,
                "firstSuccessfulWorkflowId": "JsDBWbsoYaKBkGmW",
                "userActivatedAt": 1758182279933,
                "npsSurvey": {
                  "responded": true,
                  "lastShownAt": 1752395252283
                }
              },
              "disabled": false,
              "mfaEnabled": false,
              "lastActiveAt": "2025-12-18",
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "tags": [
    {
      "updatedAt": "2025-12-18T05:58:40.812Z",
      "createdAt": "2025-12-18T05:58:40.812Z",
      "id": "kb8uOx6YBcqD3LbX",
      "name": "production-test"
    }
  ],
  "activeVersion": null
}